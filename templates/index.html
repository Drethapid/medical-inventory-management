<!doctype html>
<html>
<head><meta charset="utf-8"><title>Inventory</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4">
<div class="container">
  <h1>Inventory</h1>
  <a class="btn btn-primary mb-3" href="#" id="addBtn">Add item</a>
  <table class="table table-sm">
    <thead><tr><th>SKU</th><th>Name</th><th>Qty</th><th>Location</th><th></th></tr></thead>
    <tbody id="tbody"></tbody>
  </table>
</div>

<!-- Simple modal for add/edit -->
<div class="modal" tabindex="-1" id="modal"><div class="modal-dialog"><div class="modal-content">
  <div class="modal-header"><h5 class="modal-title">Item</h5></div>
  <div class="modal-body">
    <form id="form">
      <input class="form-control mb-2" name="sku" placeholder="SKU" required>
      <input class="form-control mb-2" name="name" placeholder="Name" required>
      <input type="number" class="form-control mb-2" name="quantity" placeholder="Quantity" required>
      <input class="form-control mb-2" name="location" placeholder="Location">
      <input type="hidden" name="id">
    </form>
  </div>
  <div class="modal-footer">
    <button class="btn btn-secondary" id="close">Close</button>
    <button class="btn btn-primary" id="save">Save</button>
  </div>
</div></div></div>

<script>
async function load(){
  const res = await fetch('/api/items'); const items = await res.json();
  const t = document.getElementById('tbody'); t.innerHTML = '';
  for(const i of items){
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${i.sku}</td><td>${i.name}</td><td>${i.quantity}</td><td>${i.location||''}</td>
    <td>
      <button class="btn btn-sm btn-outline-secondary" onclick='edit(${JSON.stringify(i)})'>Edit</button>
      <button class="btn btn-sm btn-outline-danger" onclick='del(${i.id})'>Del</button>
    </td>`;
    t.appendChild(tr);
  }
}
function showModal(){ document.getElementById('modal').style.display='block'; }
function closeModal(){ document.getElementById('modal').style.display='none'; document.getElementById('form').reset(); }
document.getElementById('addBtn').onclick = ()=>{ showModal(); }
document.getElementById('close').onclick = closeModal;

async function del(id){
  if(!confirm('Delete item?')) return;
  await fetch('/api/items/'+id, {method:'DELETE'});
  load();
}
function edit(it){
  showModal();
  const f = document.getElementById('form');
  f.id.value = it.id; f.sku.value = it.sku; f.name.value = it.name; f.quantity.value = it.quantity; f.location.value = it.location;
}
document.getElementById('save').onclick = async ()=>{
  const f = document.getElementById('form'); const id = f.id.value;
  const body = { sku: f.sku.value, name: f.name.value, quantity: f.quantity.value, location: f.location.value };
  await fetch(id ? '/api/items/'+id : '/api/items', {method: id ? 'PUT' : 'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(body)});
  closeModal(); load();
}
load();
</script>
</body></html>
